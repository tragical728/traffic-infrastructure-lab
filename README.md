# ТЗшка трафф для @mastermind
Производственная инфраструктура для высоконагруженного трафик-арбитража с контейнеризацией Docker, балансировкой нагрузки Nginx, автоматическим развертыванием и мониторингом.

## Архитектура
```
Запрос клиента
      ↓
   Nginx LB (Порт 8080)
      ↓
   ┌──────┴──────┬──────────┐
   ↓             ↓          ↓
Landing1     Landing2   Landing3...
   ↓             ↓          ↓
nginx-exporter → Prometheus → Grafana
```

## Возможности
- **Контейнеризация Docker** - Изолированные, портативные лендинги
- **Балансировка нагрузки Nginx** - Распределение трафика между контейнерами
- **Скрипт автоматического развертывания** - Деплой новых лендингов за секунды
- **Мониторинг в реальном времени** - Дашборд Prometheus + Grafana
- **Масштабируемая архитектура** - Готова для 50+ лендингов (но надо доработать авто-деплой)

## Стек
- Docker & Docker Compose
- Nginx (Alpine)
- Prometheus
- Grafana
- Python (авто-деплой скрипт)

## Быстрый старт

### Требования
- Установленный Docker Desktop
- Python 3.x

### Установка

1. Клонировать репозиторий
```
git clone https://github.com/yourusername/traffic-infrastructure-lab.git
cd traffic-infrastructure-lab
```

2. Запустить инфраструктуру
```
docker-compose up -d --build
```

3. Доступ к сервисам
- Ленды: http://localhost:8080
- Прометей: http://localhost:9090
- Графана: http://localhost:3000 (admin/admin(попросит поменять))

## Авто-деплой нового ленда

```
python deploy.py landing5
```

Автоматически выполняет:
- Создание нового контейнера
- Добавление в upstream Nginx
- Пересборку инфраструктуры
- Обновление мониторинга

## Мониторинг

### Настройка Grafana

1. Открыть http://localhost:3000
2. Войти: admin/admin
3. Добавить источник данных Prometheus: http://prometheus:9090
4. Импортировать дашборд ID: 12708
PS либо самому дешборд с мтериками добавить, какие Вамм угодно.

### Ключевые метрики
- Активные соединения
- Запросов в секунду
- Статус upstream серверов
- Распределение трафика

## Конфигурация

### Балансировка нагрузки Nginx
Отредактируйте `nginx.conf` для настройки:
- Upstream серверов
- Алгоритма балансировки
- Проверок здоровья

### Метрики Prometheus
Отредактируйте `prometheus.yml` для добавления:
- Новых целей сбора метрик
- Кастомных метрик
- Интервалов сбора данных

## Производительность

Протестировано с:
- 4 одновременных контейнера лендингов
- Балансировка Round-robin
- Время отклика < 10мс
- Развертывание без простоев


## Планы улучшений
- [ ] Поддержка SSL/TLS
- [ ] Автомасштабирование на основе нагрузки
- [ ] Геомаршрутизация
- [ ] Интеграция с CDN
- [ ] Автоматические бэкапы


## Автор
tragic TG - @trell
